Optimaze the first() function .Just store the first() result into a table to avoid calculating twice
